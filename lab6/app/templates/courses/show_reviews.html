{% extends 'base.html' %}
{% from 'pagination.html' import render_reviews_pagination %}
{%block content%}
<div class="container">
<h2 class="mb-3 text-center text-uppercase font-weight-bold">Отзывы</h2>
<div class="my-5 p-3 bg-dark rounded">
<form  class="row align-items-center">
    <div class="col-sm-12 mb-3 col-md-4 mb-md-0">
        <p class="text-white"> Сортировать по</p>
        <select class="form-select" id="course-category" name="reviews_filter_type" title="Категория курса">
                <option value="new">По новизне</option>
                <option value="good">Сначала положительные</option>
                <option value="bad">Сначала отрицательные</option>
        </select>
    </div>
    
    <div class="col-sm-12 col-md-2 align-self-end">
        <button type="submit" class="btn btn-outline-light w-100 mt-auto">Найти</button>
    </div>
</form>
</div>

<section class="about  mb-5 border border-dark">
    {%if count==0%}
        <p class="text-center">Для данного курса нет отзывов</p>  
    {%endif%}
    {%for review in reviews%}
    <div class="mt-3">
         
        <div class="author">
            <p>Автор: {{review.user.last_name}} {{review.user.first_name}} {%if
                review.user.middle_name!=None%},{{review.user.middle_name}}{%endif%}</p>
        </div>
        <div class="rating">
            {%if review.rating==0%}
            <p>Оценка: ужасно</p>
            {%elif review.rating==1%}
            <p>Оценка: плохо</p>
            {%elif review.rating==2%}
            <p>Оценка: неудовлетворительно</p>
            {%elif review.rating==3%}
            <p>Оценка: удовлетворительно</p>
            {%elif review.rating==4%}
            <p>Оценка: хорошо</p>
            {%elif review.rating==5%}
            <p>Оценка: отлично </p>
            {%endif%}
        </div>
        
        <div class="border">
            <div class=" text-justify border border-info">
                <p>{{review.text}}</p>
            </div>
        </div>
        <div class="border-bottom border-dark">
            <p>Дата создания: {{review.created_at}}</p>
        </div>
    </div>
{%endfor%}
</section>
<div class="mb-5">
    {{ render_reviews_pagination(pagination, request.endpoint, course_id=course.id,reviews_filter_type=request.args.get('reviews_filter_type')) }}
</div>
</div>
{%if existing_review!=None%}
<h2 class="mb-3 text-center text-uppercase font-weight-bold">Ваш отзыв</h2>
<section class="about  mb-5 border border-dark container"> 
        <div class="author">
            <p>Автор: {{existing_review.user.last_name}} {{existing_review.user.first_name}} {%if
                existing_review.user.middle_name!=None%},{{existing_review.user.middle_name}}{%endif%}</p>
        </div>
        <div class="rating">
            {%if existing_review.rating==0%}
            <p>Оценка: ужасно</p>
            {%elif existing_review.rating==1%}
            <p>Оценка: плохо</p>
            {%elif existing_review.rating==2%}
            <p>Оценка: неудовлетворительно</p>
            {%elif existing_review.rating==3%}
            <p>Оценка: удовлетворительно</p>
            {%elif existing_review.rating==4%}
            <p>Оценка: хорошо</p>
            {%elif existing_review.rating==5%}
            <p>Оценка: отлично </p>
            {%endif%}
        </div>
        
        <div class="border">
            <div class=" text-justify border border-info">
                <p>{{existing_review.text}}</p>
            </div>
        </div>
        <div class="border">
            <p>Дата создания: {{existing_review.created_at}}</p>
        </div>
</section>
{%else%}
{%include 'courses/create_review.html'%}
{%endif%}
{%endblock%}